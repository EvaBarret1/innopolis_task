# innopolis_task
Основные тейки 
Задания
1. Исследование и предварительная обработка данных:
● Объясните любые неточности или ошибки в наборе данных и способы их исправления.
● Напишите код для предварительной обработки и нормализации набора данных.
● Часть предварительной обработки будет в значительной степени выполняться на лидарном облаке точек, вокселизации, наземных
сегментация и т.д.
2. Модель обнаружения объектов:
● Создайте простую модель обнаружения объектов изображения с помощью PyTorch.
● Математически объяснить архитектуру и выбор функций потерь.
● Объясните используемые показатели производительности.
● Используйте существующую модель для обнаружения объектов с помощью облака точек лидара.
● В чем основное отличие архитектуры нейронных сетей обнаружения лидарных объектов?
и нейронные сети обнаружения объектов изображения?
3. Алгоритм объединения датчиков
● Внедрить простой алгоритм объединения датчиков позднего слияния для объединения детектирования RGB и
Лидарные обнаружения.
● Объясните математическую модель, используемую для объединения датчиков.
4. Калибровка
● Напишите код для калибровки датчиков, гарантируя, что данные от разных датчиков совпадают.
выровнено.
● Обсудить математические аспекты используемых алгоритмов калибровки.
5. Обертка узла ROS2
● Включите алгоритмы обнаружения объектов и объединения датчиков в узлы ROS2.
● Каждый узел должен иметь только 1 задачу.
● Избегайте плохих шаблонов проектирования.
● Узлы должны работать вместе, чтобы сделать весь конвейер максимально эффективным и быстрым.
возможный.
6. Документация и тестирование
● Напишите модульные тесты для каждой реализованной функции.
● Строго документируйте код и алгоритмы.
Набор данных
Папка Kitti номер 0 содержит 154 изображения RGB и 154 облака точек Velodyne, а также
файл метки для обучения и калибровки нейронных сетей, содержащий внешние и внутренние данные.
data и файл oxt, содержащий данные GPS. Автомобиль движется за велосипедистом и фургоном, поэтому
идеально подходит для отслеживания и объединения датчиков
1) reserch
2) Architecture and choice of loss functions
Архитектura и выбор функций потерь:

Эта модель использует простую архитектуру сверточной нейронной сети (CNN) в качестве базовой сети (backbone) для извлечения признаков из входного изображения. Затем модель разветвляется на две головы: одна для предсказания ограничивающих боксов (bbox_head) и одна для предсказания классов объектов (cls_head).

Для обучения модели мы можем использовать комбинацию функции потерь по ограничивающим боксам (например, среднеквадратичная ошибка или smooth L1 loss) и функции потерь по классификации (например, перекрестная энтропия). Эта комбинация потерь позволяет модели одновременно предсказывать положение и класс объектов на изображении.

Показатели производительности:

Для оценки производительности модели обнаружения объектов обычно используются следующие показатели:

- Точность (Precision): Доля правильно предсказанных объектов среди всех предсказанных объектов.
- Полнота (Recall): Доля правильно предсказанных объектов среди всех фактических объектов.
- Средняя точность (mAP, Mean Average Precision): Усредненная точность по всем классам объектов.
- F1-мера: Гармоническое среднее между точностью и полнотой.

Эти показатели помогают оценить способность модели точно обнаруживать объекты различных классов.

Использование модели с облаком точек лидара:

Для использования модели обнаружения объектов с облаком точек лидара, нам потребуется модифицировать архитектуру. Основное отличие будет заключаться в том, что вместо обработки 2D изображений, мы будем работать с 3D облаком точек.

Одна из возможных архитектур для обнаружения объектов с использованием лидарных данных - это VoxelNet. Эта модель разбивает облако точек на 3D-вокселы и затем использует сверточные слои для извлечения признаков из этих вокселов. Далее следует набор полносвязных слоев для предсказания ограничивающих боксов и классов объектов.Ключевое отличие в архитектуре между моделями обнаружения объектов на изображениях и лидарных данных заключается в том, что модели для лидара должны уметь обрабатывать неструктурированные 3D-данные, в то время как модели для изображений работают с регулярными 2D-данными. Это приводит к различным способам извлечения признаков и архитектурам нейронных сетей.

Например, в модели обнаружения объектов на основе лидара, вместо сверточных слоев, используются 3D-сверточные слои для обработки 3D-вокселов. Кроме того, могут применяться специальные модули, такие какPointNet, для извлечения признаков непосредственно из необработанных точек облака.

В целом, модели обнаружения объектов на основе лидарных данных должны быть адаптированы к работе с 3D-данными, в то время как модели для изображений фокусируются на обработке 2D-данных.
3)
Математическая модель для объединения датчиков:

Пусть у нас есть два набора обнаруженных объектов: один из RGB-изображений (XRGB) и один из лидарных данных (Xlidar). Каждый набор содержит ограничивающие боксы, классификационные оценки и другую информацию об обнаруженных объектах.

Мы можем объединить эти два набора данных с помощью простого алгоритма позднего слияния, основанного на пространственном совпадении:

1. Для каждого обнаруженного объекта в XRGB находим ближайший обнаруженный объект в Xlidar по пространственному положению (например, используя расстояние центров боксов).
2. Если расстояние между центрами боксов меньше заданного порога, мы считаем, что это один и тот же объект, обнаруженный обоими сенсорами.
3. Для этого объекта мы объединяем информацию из обоих наборов данных: берем среднее значение ограничивающего бокса, максимальное значение классификационной оценки и другие релевантные данные.
4. Если для объекта из XRGB не найден близкий объект в Xlidar, или наоборот, мы сохраняем этот объект как отдельный в объединенном наборе данных.

Математически это можно записать следующим образом:

Пусть X_i^RGB и X_j^lidar - i-й объект из XRGB и j-й объект из Xlidar соответственно
